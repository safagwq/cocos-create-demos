window.__require=function t(e,n,o){function i(r,s){if(!n[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var u="function"==typeof __require&&__require;if(!s&&u)return u(l,!0);if(c)return c(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var a=n[r]={exports:{}};e[r][0].call(a.exports,function(t){return i(e[r][1][t]||t)},a,a.exports,t,e,n,o)}return n[r].exports}for(var c="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({Main:[function(t,e,n){"use strict";cc._RF.push(e,"ac488cBHj9Eb6tpkZs1hWyt","Main");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,c=arguments.length,r=c<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(c<3?i(r):c>3?i(e,n,r):i(e,n))||r);return c>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var c=t("./lib/util"),r=cc._decorator,s=r.ccclass,l=r.property,u=[{type:-1,color:"888888"},{type:0,color:"000000"},{type:1,color:"ff0000"},{type:2,color:"ffff00"},{type:3,color:"00ff00"},{type:4,color:"00ffff"},{type:5,color:"ff00ff"},{type:6,color:"ffffff"}].filter(function(t){return t.type>0}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Box=null,e.reloadButton=null,e.debugReloadButton=null,e.createHistory=[],e.selectHistory=[],e.idCount=0,e.list=[],e.selectA=null,e.selectB=null,e.checking=!1,e.messageComponent=null,e._score=0,e.scoreComponent=null,e}return o(e,t),Object.defineProperty(e.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,this.scoreComponent.string=t+""},enumerable:!0,configurable:!0}),e.prototype.createBox=function(){var t=this,e=this.idCount,n={id:e,x:e%10,y:Math.floor(e/10),checked:!1,selected:!1,type:0,color:"",node:cc.instantiate(this.Box)},o=c.getRandomItem(u);return this.createHistory[this.idCount]&&(o=this.createHistory[this.idCount]),Object.assign(n,o),this.createHistory.push(o),this.idCount++,n.node.color=cc.color(n.color),n.node.setPosition(this.getBoxPosition(n)),n.node.getComponentInChildren(cc.Label).string=n.x+","+n.y,n.node.on(cc.Node.EventType.TOUCH_START,function(){t.select(n)}),n},e.prototype.getBoxPosition=function(t){return cc.v2(36*(t.x-5),36*(t.y-5))},e.prototype.getBox=function(t,e){return this.list[10*e+t]||null},e.prototype.setSelectA=function(t){t.selected=!0,t.node.children[0].active=!0,this.selectA=t},e.prototype.setSelectB=function(t){var e=this;t.selected=!0,t.node.children[0].active=!0,this.selectB=t;var n=this.selectA,o=n.x,i=n.y,c=this.selectB,r=c.x,s=c.y,l=10*i+o,u=10*s+r;this.checking=!0,this.selectA.x=r,this.selectA.y=s,this.selectB.x=o,this.selectB.y=i,this.selectA.node.getComponentInChildren(cc.Label).string=this.selectA.x+","+this.selectA.y,this.selectB.node.getComponentInChildren(cc.Label).string=this.selectB.x+","+this.selectB.y,this.selectA.node.runAction(cc.moveTo(.3,this.getBoxPosition(this.selectA))),this.selectB.node.runAction(cc.moveTo(.3,this.getBoxPosition(this.selectB))),setTimeout(function(){e.list[l]=e.selectB,e.list[u]=e.selectA,0==e.check([e.selectA,e.selectB])&&(e.selectA.x=o,e.selectA.y=i,e.selectB.x=r,e.selectB.y=s,e.selectA.node.getComponentInChildren(cc.Label).string=e.selectA.x+","+e.selectA.y,e.selectB.node.getComponentInChildren(cc.Label).string=e.selectB.x+","+e.selectB.y,e.selectA.node.runAction(cc.moveTo(.3,e.getBoxPosition(e.selectA))),e.selectB.node.runAction(cc.moveTo(.3,e.getBoxPosition(e.selectB))),e.list[l]=e.selectA,e.list[u]=e.selectB,setTimeout(function(){e.checking=!1},300)),e.selectA.selected=!1,e.selectB.selected=!1,e.selectA.node.children[0].active=!1,e.selectB.node.children[0].active=!1,e.selectA=null,e.selectB=null},400)},e.prototype.updateList=function(t,e){var n=this;t.forEach(function(t){var e=function(t){return 0==t.type},o=t[0].x,i=t.filter(e).length,c=new Array(i).fill(null).map(function(t,e){var i=n.createBox();return i.x=o,i.y=10+e,i.node.setPosition(n.getBoxPosition(i)),i.node.runAction(cc.fadeIn(.2)),n.node.addChild(i.node),i});t.push.apply(t,c);var r=t.filter(function(t){return 0!=t.type});setTimeout(function(){var o=function(n){return t.slice(0,t.indexOf(n)).filter(e).length};r.forEach(function(t){t.y-=o(t),t.node.getComponentInChildren(cc.Label).string=t.x+","+t.y,n.list[10*t.y+t.x]=t,t.node.runAction(cc.moveTo(.3,n.getBoxPosition(t)))})},500)}),setTimeout(function(){var t=e.map(function(t){return n.getBox(t.x,t.y)});0==n.check(t)&&(n.checking=!1)},1500)},e.prototype.clear=function(t){t.forEach(function(t){t.type=0,t.node.runAction(cc.repeatForever(cc.sequence(cc.fadeOut(.1),cc.fadeIn(.1))))}),this.score+=t.length,setTimeout(function(){t.forEach(function(t){t.node.destroy()})},500)},e.prototype.check=function(t){var e=this,n=c.xxlCheck(this.list,10,10,t);return!!n&&(this.clear(n.clearList),setTimeout(function(){e.updateList(n.updateColumnList,n.unionList)},500),!0)},e.prototype.select=function(t){this.checking||t.type<1||(this.selectHistory.push(this.list.indexOf(t)),null!=this.selectA?this.selectA!=t&&(this.selectA.x==t.x&&1==Math.abs(this.selectA.y-t.y)?this.setSelectB(t):this.selectA.y==t.y&&1==Math.abs(this.selectA.x-t.x)?this.setSelectB(t):(this.selectA.selected=!1,this.selectA.node.children[0].active=!1,this.setSelectA(t))):this.setSelectA(t))},e.prototype.message=function(t){this.messageComponent.string=t},e.prototype.initEvent=function(){var t=this;this.reloadButton.node.on("click",function(){localStorage.createCache="",localStorage.selectCache="",location.reload()}),this.debugReloadButton.node.on("click",function(){localStorage.debugTipsCount||(localStorage.debugTipsCount="0"),parseInt(localStorage.debugTipsCount)<3&&(alert("debug \u6a21\u5f0f\u91cd\u73a9\u7684\u8bdd\u4f1a\u628a\u5f53\u524d\u7684\u64cd\u4f5c\u8bb0\u5f55\u548c\u65b9\u5757\u72b6\u6001\u8bb0\u5f55\u4e0b\u6765\u5e76\u81ea\u52a8\u64ad\u653e , \u4ee5\u4fbf\u8c03\u8bd5bug\u4f7f\u7528"),localStorage.debugTipsCount=parseInt(localStorage.debugTipsCount)+1),localStorage.createCache=JSON.stringify(t.createHistory),localStorage.selectCache=JSON.stringify(t.selectHistory),location.reload()})},e.prototype.initCache=function(){var t=this;try{this.createHistory=JSON.parse(localStorage.createCache);var e=JSON.parse(localStorage.selectCache);if(e.length>=2){this.message('\u81ea\u52a8\u64ad\u653e\u5f00\u59cb\n\u6309"\u91cd\u65b0\u5f00\u59cb"\u53ef\u4ee5\u9000\u51fadebug\u6a21\u5f0f\u7ee7\u7eed\u6e38\u73a9');var n=null,o=function(){if(!t.checking){if(0==e.length)return t.message("\u81ea\u52a8\u64ad\u653e\u7ed3\u675f!"),void clearTimeout(n);var i=e.shift();t.select(t.list[i])}n=setTimeout(o,500)};n=setTimeout(o,1e3)}}catch(t){}},e.prototype.initView=function(){var t=this;this.list=new Array(100).fill(null).map(function(){var e=t.createBox();return t.node.addChild(e.node),e})},e.prototype.initMessage=function(){var t=new cc.Node("MessageComponent"),e=t.addComponent(cc.Label);e.fontSize=14,e.lineHeight=0,t.setPosition(0,260),this.node.parent.addChild(t),this.messageComponent=e},e.prototype.initScore=function(){var t=new cc.Node("Score"),e=t.addComponent(cc.Label);e.fontSize=16,e.lineHeight=0,t.setPosition(140,280),t.color=cc.color("ffff00"),this.node.parent.addChild(t),this.scoreComponent=e,this.score=0},e.prototype.start=function(){window.m=this,this.initMessage(),this.initScore(),this.initEvent(),this.initCache(),this.initView()},i([l(cc.Prefab)],e.prototype,"Box",void 0),i([l(cc.Button)],e.prototype,"reloadButton",void 0),i([l(cc.Button)],e.prototype,"debugReloadButton",void 0),e=i([s],e)}(cc.Component);n.default=a,cc._RF.pop()},{"./lib/util":"util"}],util:[function(t,e,n){"use strict";cc._RF.push(e,"88f3fP7KKhIZrwKSwyb9oww","util"),Object.defineProperty(n,"__esModule",{value:!0});var o=null,i=0;function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0]||[],o=t.slice(1),i=new Set(n);return o.forEach(function(t){t.forEach(function(t){return i.add(t)})}),Array.from(i)}function r(t,e){for(var n=[],o=0;o<t.length;o+=e)n.push(t.slice(o,o+e).slice());return n}n.cloneJsonData=function(t){return JSON.parse(JSON.stringify(t))},n.getRandomItem=function(t){return t[Math.floor(Math.random()*t.length)]},n.getUnion=c,n.splitByLength=r,n.xxlCheck=function(t,e,o,i){n.xxlCheck.setData(t,e,o);var c=n.xxlCheck.quickCheck(i);if(c.length<3)return null;var r=n.xxlCheck.getUpdateUnionList(c);return{clearList:c,unionList:r,updateColumnList:n.xxlCheck.getUpdateColumn(r)}},window.xxlCheck=n.xxlCheck,n.xxlCheck.setData=function(t,e,n){o=r(t,e),e,i=n},n.xxlCheck.quickCheck=function(t){var e=this,n=[];return t.map(function(t){return e.getQuickCheckChain(t)}).forEach(function(t){t.lineChains&&n.push(t.lineChains),t.columnChains&&n.push(t.columnChains)}),c.apply(void 0,n)},n.xxlCheck.getUpdateColumn=function(t){var e=[];return t.forEach(function(t){e[t.x]||(e[t.x]=[]),e[t.x].push(t)}),e.forEach(function(t){t&&t.sort(function(t,e){return t.y-e.y})}),e.filter(function(t){return t})},n.xxlCheck.getUpdateUnionList=function(t){var e=this;return c.apply(void 0,t.map(function(t){for(var n=[],o=t.y;o<i;o++)n.push(e.getBox(t.x,o));return n}))},n.xxlCheck.getQuickCheckChain=function(t){var e=this,n=this.getQuickCheckAround(t),o=[t],i=[t];return Object.keys(n).map(function(t){var o=n[t];o.every(function(t){return t})&&o.push.apply(o,e.getChainByDirection(o[1],t))}),n.left.every(function(t){return!!t&&(o.unshift(t),!0)}),n.right.every(function(t){return!!t&&(o.push(t),!0)}),n.up.every(function(t){return!!t&&(i.unshift(t),!0)}),n.down.every(function(t){return!!t&&(i.push(t),!0)}),o.length<3&&(o=null),i.length<3&&(i=null),{lineChains:o,columnChains:i}},n.xxlCheck.getChainByDirection=function(t,e){for(var n=[],o=t;;){var i=this.getAroundByDirection(o,e);if(!i||i.type!=t.type)break;n.push(i),o=i}return n},n.xxlCheck.getAroundByDirection=function(t,e){var n=t.x,o=t.y;switch(e){case"up":return this.getBox(n,o+1);case"down":return this.getBox(n,o-1);case"left":return this.getBox(n-1,o);case"right":return this.getBox(n+1,o)}return null},n.xxlCheck.getBox=function(t,e){return o[e]&&o[e][t]||null},n.xxlCheck.getQuickCheckAround=function(t){var e=t.x,n=t.y,o=[this.getBox(e,n+1),this.getBox(e,n+2),this.getBox(e,n-1),this.getBox(e,n-2),this.getBox(e-1,n),this.getBox(e-2,n),this.getBox(e+1,n),this.getBox(e+2,n)].map(function(e){return e&&e.type==t.type?e:null});return{up:[o[0],o[1]],down:[o[2],o[3]],left:[o[4],o[5]],right:[o[6],o[7]]}},cc._RF.pop()},{}]},{},["Main","util"]);